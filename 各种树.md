## 演示网址

**https://www.cs.usfca.edu/~galles/visualization/Algorithms.html**

### 2-3树

- **定义**

  - 一种保持有序结构的查找树
  - 可以维持动态平衡的有序查找树
  - 2-3树是最简单的B-树（或-树）结构，其每个非叶节点都有两个或三个子女，而且所有叶都在统一层上。2-3树不是二叉树，其节点可拥有3个孩子。不过，2-3树与满二叉树相似。高为h的2-3树包含的节点数大于等于高度为h的满二叉树的节点数，即至少有2^h-1个节点。

- 维基百科定义

  - 如果一个内部节点拥有一个数据元素、两个子节点，则此节点为2节点

  - 如果一个内部节点拥有两个数据元素、三个子节点，则此节点为3节点

  - 当且仅当以下叙述中有一条成立时，T为2–3树：

    - T为空。即T不包含任何节点

    - T为拥有数据元素a的2节点。若T的左孩子为L、右孩子为R，则

      - L和R是等高的非空2–3树；
      - a大于L中的所有数据元素；同时
      - a小于等于R中的所有数据元素。

    - T为拥有数据元素a和b的3节点，其中a < b。若T的左孩子为L、中孩子为M、右孩子为R，则

    - - L、M、和R是等高的非空2–3树；
      - a大于L中的所有数据元素，并且小于等于M中的所有数据元素；同时
      - b大于M中的所有数据元素，并且小于等于R中的所有数据元素

- 一个2-3树

![](F:\python\数据结构\总结文档\树图\2-3树.jpg)

- 2-3的插入操作

  先找到需要插入的位置，插入的内容是k，位置就是按照查找的方式找到叶节点 n。这个叶节点有两种情况：

  -  这个节点是2节点
    - 将k放入到节点n中。然后n变成了一个3节点。
  - 这个节点是3节点
    - 假设2-3树只包含一个节点，这个节点又是叶节点。也就是说这个树内只包含一个节点。这个节点是三元的。那么向这个节点插入数据的时候，首先这个节点会临时的变成四个节点，内部有三个元素。这三个元素中中间的新生成一个node叫做m，右边的元素也新生成一个node叫做n，原来的跟节点叫做l。那么n和l和m都是二元的节点。将m变成新的跟节点，l是m的左子树，n是m的右子树。
    - 如果不是只有一个节点，那么我们通过查找的方式一直查找到叶节点，发现叶节点是三元的，那么就需要像a)中描述的那样，先插入生成临时的4节点，然后将右侧的元素取出，单独生成一个节点。而后将中间节点插入到上层。就循环这个插入过程，直到插入完成。

### 红黑树

- 理解
  - 当我们需要使二叉查找树达到平衡从而使查找的时间复杂度保持在logn的时候，可以使用2-3-4树，但是2-3-4实现起来比较困难，红黑树这种结构等同于2-3-4树，从而使用红黑树。

- 先理解二叉查找树（BST）

  - **左**子树上所有结点的值均**小于或等于**它的根结点的值。
  - **右**子树上所有结点的值均**大于或等于**它的根结点的值。
  - 左、右子树也分别为二叉排序树。

- **一个典型的二叉查找树**

  ![](F:\python\数据结构\总结文档\树图\二叉查找树.jpg)

- 但是二叉查找树会有一定的缺陷，比如要插入的数值一直在左侧（左斜二叉树）或者一直在右侧（右斜二叉树），就会造成其查找效率成为线性的，从而失去了二叉树的相对高效率特性，从而引出了**红黑树**。


- **定义**
  - 是一种自平衡的二叉查找树，除了符合二叉查找树的基本特性外，它还具有下列的附加特性：
    - 1.节点是红色或黑色
    - 2.根结点是黑色
    - 3.每个叶子结点都是黑色的空节点（NIL节点）
    - 4.每个红色节点的两个子节点都是黑色。(从每个叶子到根的所有路径上不能有两个连续的红色节点)
    - 5.从任一节点到其每个叶子的所有路径都包含相同数目的黑色节点。
  - 红黑树其实等同于2-3-4树，但由于2-3-4树不好实现，所以采用了红黑树这种结构来体现。
  - 红黑树从根到叶子的最长路径不会超过最短路径的2倍
- **一个典型的红黑树**

![](F:\python\数据结构\总结文档\树图\典型的红黑树.jpg)

- **变色**

  - 当插入或者删除某个节点时，可能会造成某一条路径上出现连续的两个红色节点或者某跳路径的黑色节点数量不同于其他路径数量，这种时候都需要我们进行一连串的变色去尝试使这个红黑树重新达到原先的规则。

- **左旋转**

  - **逆时针**旋转红黑树的两个节点，使得父节点被自己的右孩子取代，而自己成为自己的左孩子。说起来很怪异，大家看下图：

  ![](F:\python\数据结构\总结文档\树图\左旋转.png)

  ​	图中，身为右孩子的Y取代了X的位置，而X变成了自己的左孩子。此为左旋转。

- **右旋转：**

  - **顺时针**旋转红黑树的两个节点，使得父节点被自己的左孩子取代，而自己成为自己的右孩子。大家看下图：

  ![](F:\python\数据结构\总结文档\树图\右旋转.png)

  ​	图中，身为左孩子的Y取代了X的位置，而X变成了自己的右孩子。此为右旋转。

- 应用

  - 红黑树的应用有很多，其中Python的Set数据类型使用Hash函数和Hash表实现的，但是Hash表的底层就是用红黑树来做的。

### B Tree

- **定义**

  - B树是一种自平衡树数据结构，它维护有序数据并允许以对数时间进行搜索，顺序访问，插入和删除。B树是二叉搜索树的一般化，因为节点可以有两个以上的子节点。与自平衡二进制搜索树不同，B树非常适合读取和写入相对较大的数据块（如光盘）的存储系统。它通常用于数据库和文件系统。MongoDB的索引。

- B树，一个m阶的B树具有如下几个特征：

  - 根结点至少有两个子女。
  - 每个中间节点都包含k-1个元素和k个孩子，其中 m/2 <= k <= m
  - 每一个叶子节点都包含k-1个元素，其中 m/2 <= k <= m
  - 所有的叶子结点都位于同一层。
  - 每个节点中的元素从小到大排列，节点当中k-1个元素正好是k个孩子包含的元素的值域分划。

- 依次插入5-19-14-9-12-4-3-7-10-16-15-11，使用4阶B树，得：

  ![](F:\python\数据结构\总结文档\树图\B树.png)

### B+ Tree

- **一个m阶的B+树具有如下几个特征：**

  - 有k个子树的中间节点包含有k个元素（B树中是k-1个元素），每个元素不保存数据，只用来索引，所有数据都保存在叶子节点。
  - 所有的叶子结点中包含了全部元素的信息，及指向含这些元素记录的指针，且叶子结点本身依关键字的大小自小而大顺序链接。
  - 所有的中间节点元素都同时存在于子节点，在子节点元素中是最大（或最小）元素。

- **B+树比B树的优势：**

  - 单一节点存储更多的元素，使得查询的IO次数更少。
  - 所有查询都要查找到叶子节点，查询性能稳定。
  - 所有叶子节点形成有序链表，便于范围查询。

- 依次插入5-19-14-9-12-4-3-7-10-16-15-11，使用4阶B+树，得：

  ![](F:\python\数据结构\总结文档\树图\B+树.png)

  - 同样的一组数据，插入的顺序不同，所构成的B+树都有可能不同